<!DOCTYPE html>
<html lang="en">
<head>
    <title>ModelEdit</title>
        <script type="text/javascript" src="http://code.jquery.com/jquery-2.0.2.min.js"></script>
        <script type="text/javascript" src="editor.js"></script>

        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>Model Editor</title>
        <style type="text/css" media="screen">
            body { overflow: hidden; background: #112}
            #editor { position: absolute; top: 0; bottom: 0; left: 50%; width: 50%; height: 100%; }
            #modelview { position: absolute; left: 0; top: 0; width:50%; height:80%; }
            #errorview { position: absolute; left: 0; top: 80%; width:50%; height:20%; }
        </style>
</head>

<body onload="Editor.initEditor();">

<canvas id="modelview">
  canvas default text
</canvas><br/>

<script type="text/javascript">
    var canvas = document.getElementById("modelview");
    var Module = {};
    Module.canvas = canvas;
</script>

<script type="text/javascript" src="main.js"></script>
<script type="text/javascript" src="trampoline.js"></script>

<script type="text/javascript">
    var program = new Program(canvas);
</script>

<div>
<pre id="editor">

{
  "type" : "Model",
  "name" : "box",
  "elements" : [
    {
      "type" : "Texture",
      "name" : "spots",
      "file" : "assets/spots.png",
      "unit" : 0
    },
    {
      "type" : "Assumption",
      "name" : "woodMaterial",
      "effect" : "phongWithTexture",
      "color" : [1.0, 1.0, 1.1, 1 ],
      "texture" : "spots"
    },
    {
      "type" : "Assumption",
      "name" : "cubeTransform"
    },
    {
      "type" : "Assumption",
      "name" : "context"
    },
    {
      "type" : "Effect",
      "name" : "phongWithTexture",
      "vertexCode" : "
        uniform mat4 modelView;
        uniform mat4 projection;

        attribute vec3 vertex;
        attribute vec3 normal;
        attribute vec2 texcoord;

        varying vec3 v_position;
        varying vec3 v_normal;
        varying vec2 v_texCoord;

        void main()
        {
          v_position = vertex;
          v_normal = normal;
          v_texCoord = texcoord;
          gl_Position = projection * modelView * vec4(vertex, 1.0);
        }
        ",
      "fragmentCode" : "
        varying vec3 v_position;
        varying vec3 v_normal;
        varying vec2 v_texCoord;

        uniform sampler2D texture;
        uniform vec4 color;

        void main()
        {
          float t = dot(v_normal, vec3(0.3,0.5,1.0));
          if( t < 0.1 ) t = 0.1;
          gl_FragColor = color * vec4(t * color.xyz * texture2D(texture, v_texCoord).xyz, 1.0);
        }
        "
    },
    {
      "type" : "Shape",
      "name" : "cubeShape",
      "geometry" : "cube_mesh_geometry",
      "assumptions" : [
        "woodMaterial",
        "cubeTransform",
        "context"
      ]
    },
    {
      "type" : "Buffer",
      "name" : "cube_mesh_vertices",
      "array" : [
        -2.0, -2.0, 2.0, 0, 0, 1, 0.2, 0.2,
        2.0, -2.0, 2.0, 0, 0, 1, 0.5, 0.2,
        2.0, 2.0, 2.0, 0, 0, 1, 0.5, 0.5,
        -2.0, 2.0, 2.0, 0, 0, 1, 0.2, 0.5,

        -2.0, 2.0, 2.0, 0, 1, 0, 0.5, 0.8,
        2.0, 2.0, 2.0, 0, 1, 0, 0.8, 0.8,
        2.0, 2.0, -2.0, 0, 1, 0, 0.8, 0.5,
        -2.0, 2.0, -2.0, 0, 1, 0, 0.5, 0.5,

        -2.0, 2.0, -2.0, 0, 0, -1, 0.2, 0.8,
        2.0, 2.0, -2.0, 0, 0, -1, 0.5, 0.8,
        2.0, -2.0, -2.0, 0, 0, -1, 0.5, 0.5,
        -2.0, -2.0, -2.0, 0, 0, -1, 0.2, 0.5,

        -2.0, -2.0, -2.0, 0, -1, 0, 0.2, 0.5,
        2.0, -2.0, -2.0, 0, -1, 0, 0.5, 0.5,
        2.0, -2.0, 2.0, 0, -1, 0, 0.5, 0.8,
        -2.0, -2.0, 2.0, 0, -1, 0, 0.2, 0.8,

        2.0, -2.0, 2.0, 1, 0, 0, 0.3, 0.8,
        2.0, -2.0, -2.0, 1, 0, 0, 0.3, 0.5,
        2.0, 2.0, -2.0, 1, 0, 0, 0.6, 0.5,
        2.0, 2.0, 2.0, 1, 0, 0, 0.6, 0.8,

        -2.0, -2.0, -2.0, -1, 0, 0, 0.3, 0.5,
        -2.0, -2.0, 2.0, -1, 0, 0, 0.3, 0.8,
        -2.0, 2.0, 2.0, -1, 0, 0, 0.6, 0.8,
        -2.0, 2.0, -2.0, -1, 0, 0, 0.6, 0.5
      ]
    },
    {
      "type" : "IndexBuffer",
      "name" : "cube_mesh_indices",
      "array" : [
        0, 1, 2,
        0, 2, 3,
        4, 5, 6,
        4, 6, 7,
        8, 9, 10,
        8, 10, 11,
        12, 13, 14,
        12, 14, 15,
        16, 17, 18,
        16, 18, 19,
        20, 21, 22,
        20, 22, 23
      ]
    },
    {
      "type" : "Geometry",
      "name" : "cube_mesh_geometry",
      "indices" : "cube_mesh_indices",
      "normal" : { "type" : "Field", "buffer" : "cube_mesh_vertices", "size" : 3, "stride" : 8, "offset" : 3 },
      "texcoord" : { "type" : "Field", "buffer" : "cube_mesh_vertices", "size" : 2, "stride" : 8, "offset" : 6 },
      "vertex" : { "type" : "Field", "buffer" : "cube_mesh_vertices", "size" : 3, "stride" : 8, "offset" : 0 }
    }
  ]
}


</pre>
</div>

<div id="errorview">
</div>

<script src="ace-builds/src-noconflict/ace.js" type="text/javascript" charset="utf-8"></script>

</body>
</html>
