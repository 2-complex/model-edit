<!DOCTYPE html>
<html lang="en">
<head>
    <title>ModelEdit</title>

    <link rel="stylesheet" type="text/css" media="screen" href="w2ui/dist/w2ui.css" />
    <link rel="stylesheet" type="text/css" media="screen" href="w2ui/libs/font-awesome/font-awesome.css" />
    <script type="text/javascript" src="w2ui/libs/jquery/jquery-2.1.0.min.js"></script>
    <script type="text/javascript" src="w2ui/src/w2utils.js"></script>
    <script type="text/javascript" src="w2ui/src/w2sidebar.js"></script>
    <script type="text/javascript" src="editor.js"></script>


    <script>
$(function () {
    $('#sidebar').w2sidebar({
        name        : 'sidebar',
        img         : null,
        topHTML     : '<div style="padding: 10px 5px; border-bottom: 1px solid #aaa;">This is text</div>',
        bottomHTML  : '<div style="padding: 10px 5px; border-top: 1px solid #aaa;">Bottom</div>',
        style       : 'border: 1px solid silver',
        routeData   : { id: 59, vid: '23.323.4' },
        menu: [
            { id: 1, text: 'Select Item', icon: 'fa-star' },
            { id: 2, text: 'View Item', icon: 'fa-camera' },
            { id: 4, text: 'Delete Item', icon: 'fa-minus' }
        ],
        onMenuClick: function (event) {
            console.log(event);
        },
        onFocus: function (event) {
            console.log('focus: ', this.name, event);
            // event.preventDefault();
        },
        onBlur: function (event) {
            console.log('blur: ', this.name, event);
            // event.preventDefault();
        },
        //onKeydown: function (event) { console.log('keyboard', event); event.preventDefault(); },
        nodes: [
            { id: 'level-1', text: 'Level 1', expanded: true, group: true,
                nodes: [
                    { id: 'level-1-1', text: 'Level 1.1', img1: 'icon-add', icon: 'fa-star', count: 1,
                        route: '/project',
                        onClick: function (event) { console.log('item', event); }
                    },
                    { id: 'level-1-2', text: 'Level 1.2', img1: 'icon-save', icon: 'fa-camera', count: 'some',
                        route: '/project/:id',
                    },
                    { id: 'level-1-3', text: '<div>Level 2 <input id="check2" type="checkbox" style="float:right" onclick="console.log(\'check clicked\')"></div>', img: 'icon-delete', disabled1: true,
                        route: '/project/:id/view',
                    }
                ]
            },
            { id: 'level-2', text: 'Level 2', img: 'icon-folder', expanded: true, group: true,
              nodes: [ { id: 'level-2-1', text: 'Level 2.1', img: 'icon-folder',
                         nodes: [
                           { id: 'level-2-1-1', text: 'Level 2.1.1', img: 'icon-page', count: '4', route: '/some/:id/:vid'},
                           { id: 'level-2-1-2', text: 'Level 2.1.2', img: 'icon-page', count: '10', route: '/some/:id/:vid/ok' },
                           { id: 'level-2-1-3', text: 'Level 2.1.3', img: 'icon-page', count: '22', route: '/some/:id/:vid,:id' },
                           { id: 'level-2-1-4', text: 'Level 2.1.4', img: 'icon-page' },
                           { id: 'level-2-1-5', text: 'Level 2.1.5', img: 'icon-page' },
                           { id: 'level-2-1-6', text: 'Level 2.1.6', img: 'icon-page' },
                           { id: 'level-2-1-7', text: 'Level 2.1.7', img: 'icon-page' },
                           { id: 'level-2-1-8', text: 'Level 2.1.7', img: 'icon-page' },
                           { id: 'level-2-1-9', text: 'Level 2.1.7', img: 'icon-page' },
                           { id: 'level-2-1-10', text: 'Level 2.1.10', img: 'icon-page' },
                           { id: 'level-2-1-11', text: 'Level 2.1.11', img: 'icon-page' },
                           { id: 'level-2-1-12', text: 'Level 2.1.12', img: 'icon-page' },
                           { id: 'level-2-1-13', text: 'Level 2.1.13', img: 'icon-page' },
                           { id: 'level-2-1-14', text: 'Level 2.1.14', img: 'icon-page' },
                           { id: 'level-2-1-15', text: 'Level 2.1.15', img: 'icon-page' },
                     ]},
                       { id: 'level-3-1', text: 'Level 3.1', img: 'icon-folder', expanded: true,
                         nodes: [
                           { id: 'level-3-1-1', text: 'Level 3.1.1', icon: 'fa-beer', disabled: true },
                           { id: 'level-3-1-2', text: 'Level 3.1.2', icon: 'fa-envelope' },
                           { id: 'level-3-1-3', text: 'Level 3.1.3', icon: 'fa-ok' },
                           { id: 'level-3-1-4', text: 'Level 3.1.4', icon: 'fa-heart' },
                           { id: 'level-3-1-5', text: 'Level 3.1.5', icon: 'fa-globe', disabled: true },
                           { id: 'level-3-1-6', text: 'Level 3.1.6', icon: 'fa-reorder' },
                           { id: 'level-3-1-7', text: 'Level 3.1.7', icon: 'fa-user-md' },
                           { id: 'level-3-1-8', text: 'Level 3.1.8', icon: 'fa-download' }
                     ]},
                       { id: 'level-4-1', text: 'Level 4.1', img: 'icon-folder',
                         nodes: [
                           { id: 'level-4-1-1', text: 'Level 4.1.1', img: 'icon-page' },
                           { id: 'level-4-1-2', text: 'Level 4.1.2', img: 'icon-page' },
                           { id: 'level-4-1-3', text: 'Level 4.1.3', img: 'icon-page' }
                     ]}
                     ]
            },
            { id: 'level-5', text: 'Level 5', img: 'icon-folder', expanded: true, group: true,
              nodes: [ { id: 'level-5-1', text: 'Level 5.1', img: 'icon-page' },
                       { id: 'level-5-2', text: 'Level 5.2', img: 'icon-page' },
                       { id: 'level-5-3', text: 'Level 5.3', img: 'icon-page' }
                     ]
            }
        ],
        onClick: function (event) {
            console.log('click', event.target, event);
        }
    });
});
</script>

    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Model Editor</title>
    <style type="text/css" media="screen">
        body { overflow: hidden; background: #112}
        #sidebar   { position: absolute; left: 0;   top: 0;   width:20%; height:100%; }
        #modelview { position: absolute; left: 20%; top: 0;   width:40%; height:80%; }
        #errorview { position: absolute; left: 20%; top: 80%; width:40%; height:20%; }
        #editor    { position: absolute; left: 60%; top: 0;   width: 40%; height: 100%; }

    </style>

</head>

<body onload="Editor.initEditor();">

<canvas id="modelview">
  canvas default text
</canvas><br/>

<script type="text/javascript">
    var canvas = document.getElementById("modelview");
    var Module = {};
    Module.canvas = canvas;
</script>

<script type="text/javascript" src="main.js"></script>
<script type="text/javascript" src="trampoline.js"></script>

<script type="text/javascript">
    var program = new Program(canvas);
</script>

<div id="sidebar"></div>

<div>
<pre id="editor">

{
  "type" : "Model",
  "name" : "box",
  "elements" : [
    {
      "type" : "Texture",
      "name" : "spots",
      "file" : "assets/spots.png",
      "unit" : 0
    },
    {
      "type" : "Assumption",
      "name" : "woodMaterial",
      "effect" : "phongWithTexture",
      "color" : [1.0, 1.0, 1.1, 1 ],
      "texture" : "spots"
    },
    {
      "type" : "Assumption",
      "name" : "cubeTransform"
    },
    {
      "type" : "Assumption",
      "name" : "context"
    },
    {
      "type" : "Effect",
      "name" : "phongWithTexture",
      "vertexCode" : "
        uniform mat4 modelView;
        uniform mat4 projection;

        attribute vec3 vertex;
        attribute vec3 normal;
        attribute vec2 texcoord;

        varying vec3 v_position;
        varying vec3 v_normal;
        varying vec2 v_texCoord;

        void main()
        {
          v_position = vertex;
          v_normal = normal;
          v_texCoord = texcoord;
          gl_Position = projection * modelView * vec4(vertex, 1.0);
        }
        ",
      "fragmentCode" : "
        varying vec3 v_position;
        varying vec3 v_normal;
        varying vec2 v_texCoord;

        uniform sampler2D texture;
        uniform vec4 color;

        void main()
        {
          float t = dot(v_normal, vec3(0.3,0.5,1.0));
          if( t < 0.1 ) t = 0.1;
          gl_FragColor = color * vec4(t * color.xyz * texture2D(texture, v_texCoord).xyz, 1.0);
        }
        "
    },
    {
      "type" : "Shape",
      "name" : "cubeShape",
      "geometry" : "cube_mesh_geometry",
      "assumptions" : [
        "woodMaterial",
        "cubeTransform",
        "context"
      ]
    },
    {
      "type" : "Buffer",
      "name" : "cube_mesh_vertices",
      "array" : [
        -2.0, -2.0, 2.0, 0, 0, 1, 0.2, 0.2,
        2.0, -2.0, 2.0, 0, 0, 1, 0.5, 0.2,
        2.0, 2.0, 2.0, 0, 0, 1, 0.5, 0.5,
        -2.0, 2.0, 2.0, 0, 0, 1, 0.2, 0.5,

        -2.0, 2.0, 2.0, 0, 1, 0, 0.5, 0.8,
        2.0, 2.0, 2.0, 0, 1, 0, 0.8, 0.8,
        2.0, 2.0, -2.0, 0, 1, 0, 0.8, 0.5,
        -2.0, 2.0, -2.0, 0, 1, 0, 0.5, 0.5,

        -2.0, 2.0, -2.0, 0, 0, -1, 0.2, 0.8,
        2.0, 2.0, -2.0, 0, 0, -1, 0.5, 0.8,
        2.0, -2.0, -2.0, 0, 0, -1, 0.5, 0.5,
        -2.0, -2.0, -2.0, 0, 0, -1, 0.2, 0.5,

        -2.0, -2.0, -2.0, 0, -1, 0, 0.2, 0.5,
        2.0, -2.0, -2.0, 0, -1, 0, 0.5, 0.5,
        2.0, -2.0, 2.0, 0, -1, 0, 0.5, 0.8,
        -2.0, -2.0, 2.0, 0, -1, 0, 0.2, 0.8,

        2.0, -2.0, 2.0, 1, 0, 0, 0.3, 0.8,
        2.0, -2.0, -2.0, 1, 0, 0, 0.3, 0.5,
        2.0, 2.0, -2.0, 1, 0, 0, 0.6, 0.5,
        2.0, 2.0, 2.0, 1, 0, 0, 0.6, 0.8,

        -2.0, -2.0, -2.0, -1, 0, 0, 0.3, 0.5,
        -2.0, -2.0, 2.0, -1, 0, 0, 0.3, 0.8,
        -2.0, 2.0, 2.0, -1, 0, 0, 0.6, 0.8,
        -2.0, 2.0, -2.0, -1, 0, 0, 0.6, 0.5
      ]
    },
    {
      "type" : "IndexBuffer",
      "name" : "cube_mesh_indices",
      "array" : [
        0, 1, 2,
        0, 2, 3,
        4, 5, 6,
        4, 6, 7,
        8, 9, 10,
        8, 10, 11,
        12, 13, 14,
        12, 14, 15,
        16, 17, 18,
        16, 18, 19,
        20, 21, 22,
        20, 22, 23
      ]
    },
    {
      "type" : "Geometry",
      "name" : "cube_mesh_geometry",
      "indices" : "cube_mesh_indices",
      "normal" : { "type" : "Field", "buffer" : "cube_mesh_vertices", "size" : 3, "stride" : 8, "offset" : 3 },
      "texcoord" : { "type" : "Field", "buffer" : "cube_mesh_vertices", "size" : 2, "stride" : 8, "offset" : 6 },
      "vertex" : { "type" : "Field", "buffer" : "cube_mesh_vertices", "size" : 3, "stride" : 8, "offset" : 0 }
    }
  ]
}


</pre>
</div>

<div id="errorview">
</div>

<script src="ace-builds/src-noconflict/ace.js" type="text/javascript" charset="utf-8"></script>

</body>
</html>
